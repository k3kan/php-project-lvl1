#!/usr/bin/env php
<?php

namespace Bin\Brain\Gcd;

$autoloadPath1 = __DIR__ . '/../../../autoload.php';
$autoloadPath2 = __DIR__ . '/../vendor/autoload.php';

if (file_exists($autoloadPath1)) {
    require_once $autoloadPath1;
} else {
    require_once $autoloadPath2;
}

use function cli\prompt;
use function cli\line;

function random()
{
    return rand(1,100);
}

line('Welcome to the Brain Game!');
line('Find the greatest common divisor of given numbers.');
$name = prompt('May I have your name?');
line("Hello, %s!", $name);


function gcd()
{
    $count = 0;
    while ($count != 3)
    {
        global $name;
        $num1 = random();
        $num2 = random();
        $num1 < $num2 ? $least = $num1 : $least= $num2;
        $nod = 1;
        line("Question: %s %s", $num1, $num2);
        $number = prompt('You answer');
        for ($i = 2; $i <= $least; $i++) {
            if ($num1 % $i === 0 && $num2 % $i === 0) {
                $nod = $i;
            }
        }
        if ( (int) $number === (int) $nod) {
            line("Correct");
            $count++;
        }
        else {
                line("'%s' is wrong answer ;(. Correct answer was '%s'.", $number, $nod);
                line("Let's try again, %s!", $name);
                break;
            }
    }
    if ($count === 3) {
        line("Congratulation, %s!", $name);
    }
}

gcd();